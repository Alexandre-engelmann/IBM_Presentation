<html>
	<head>
		<title id="insert-title">Micov works</title>
		<script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
		<script src="../scripts/load_header_footer.js"></script>
		<div class="_header"></div>
	</head>
	<!--Start here-->	
	<body>
        <h1>Projeto Java Backend - Database - Docker - Hibernate</h1>
        <h2>Lucas Mentory</h2>
        <ol>
            <li>This project was build from a <code>docker-compose.yml</code> file, show in figure below </p></li>
            <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid red; "><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></td><td><pre style="margin: 0; line-height: 125%">version: <span style="background-color: #fff0f0">&quot;3&quot;</span> 
services:
  mysql:
    image: mysql:5.7.20
    volumes:
      - <span style="background-color: #fff0f0">&quot;db_data:/var/lib/mysql&quot;</span>
    ports:
      - <span style="background-color: #fff0f0">&quot;3306:3306&quot;</span>
    environment:
      - MYSQL_ROOT_PASSWORD=password
      - MYSQL_HOST=localhost
volumes:
  db_data
</pre></td></tr></table></div>
    
        <li><p>We built this image, using the command <code>docker-compose up</code></p></li>
        <li>Then we confirm that image is running in real time with command <code>docker ps</code>. This command will show something like this</li>

        <table style="border: 1px solid black;border-collapse: collapse;width: 100%; text-align: center;">
            <tr>
                <th >CONTAINER ID </th>
                <th>IMAGE</th>
                <th>COMMAND</th>
                <th>CREATED</th>
                <th>STATUS</th>
                <th>PORTS</th>
                <th>NAME</th>
            </tr>
            <tr>
                <td>2da07f4f41ec</td>
                <td>mysql:5.7.20</td>
                <td>"docker-entrypoint.sâ€¦"</td>
                <td>26 minutes ago</td>
                <td>Up 26 minutes</td>
                <td>0.0.0.0:3306->3306/tcp</td>
                <td>mysql_ale2_mysql_1</td>
            </tr>
        </table>
        <li>Then in another terminal, I ran the container using <code>docker exec -it 2da bash</code> with leave us to unix shell</li>
        <li>In bash enviroment, execute: <code>mysql -u root -ppassword</code> command</li>
        <li>Now you are at <code>mysql</code> shell enviroment</li>
 <!--       <li>Type <code>create database mysql_test;</code></li>-->
        <li>Go inside database mysql:<code>use mysql</code></li>
        <li>Make a table named <b>Cidades</b>: <code>create table Cidades( cidade_id int AUTO_INCREMENT PRIMARY KEY, cidade_nome VARCHAR(100), tamanho_cidade DOUBLE );</code></li>
        <li>Now on Eclipse IDE</li>
        <li>I ran this program using <code>JavaSE-11</code>, so in my <code>JRE System Library</code> has a <code>java.sql</code> library</li>
        <li>Also make sure you have <code>javax.persistence-api-2.2.jar</code> on <strong>Java Build Path</strong> </li>
        <li><p>Make a java <b>Cidades class</b>:</p></li>
        <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid red; "><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">package</span> br<span style="color: #333333">.</span><span style="color: #0000CC">com</span><span style="color: #333333">.</span><span style="color: #0000CC">tutoria</span><span style="color: #333333">.</span><span style="color: #0000CC">cidades</span><span style="color: #333333">;</span>

<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">javax.persistence.Entity</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">javax.persistence.GeneratedValue</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">javax.persistence.GenerationType</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">javax.persistence.Id</span><span style="color: #333333">;</span>

<span style="color: #555555; font-weight: bold">@Entity</span>
<span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Cidades</span> <span style="color: #333333">{</span>
	<span style="color: #008800; font-weight: bold">public</span> Integer <span style="color: #0066BB; font-weight: bold">getCidade_id</span><span style="color: #333333">()</span> <span style="color: #333333">{</span>
		<span style="color: #008800; font-weight: bold">return</span> cidade_id<span style="color: #333333">;</span>
	<span style="color: #333333">}</span>
	<span style="color: #008800; font-weight: bold">public</span> String <span style="color: #0066BB; font-weight: bold">getCidade_nome</span><span style="color: #333333">()</span> <span style="color: #333333">{</span>
		<span style="color: #008800; font-weight: bold">return</span> cidade_nome<span style="color: #333333">;</span>
	<span style="color: #333333">}</span>
	<span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">setCidade_nome</span><span style="color: #333333">(</span>String cidade_nome<span style="color: #333333">)</span> <span style="color: #333333">{</span>
		<span style="color: #008800; font-weight: bold">this</span><span style="color: #333333">.</span><span style="color: #0000CC">cidade_nome</span> <span style="color: #333333">=</span> cidade_nome<span style="color: #333333">;</span>
	<span style="color: #333333">}</span>
	<span style="color: #008800; font-weight: bold">public</span> Double <span style="color: #0066BB; font-weight: bold">getTamanho_cidade</span><span style="color: #333333">()</span> <span style="color: #333333">{</span>
		<span style="color: #008800; font-weight: bold">return</span> tamanho_cidade<span style="color: #333333">;</span>
	<span style="color: #333333">}</span>
	<span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">setTamanho_cidade</span><span style="color: #333333">(</span>Double tamanho_cidade<span style="color: #333333">)</span> <span style="color: #333333">{</span>
		<span style="color: #008800; font-weight: bold">this</span><span style="color: #333333">.</span><span style="color: #0000CC">tamanho_cidade</span> <span style="color: #333333">=</span> tamanho_cidade<span style="color: #333333">;</span>
	<span style="color: #333333">}</span>
	<span style="color: #555555; font-weight: bold">@Id</span>
	<span style="color: #555555; font-weight: bold">@GeneratedValue</span><span style="color: #333333">(</span>strategy<span style="color: #333333">=</span>GenerationType<span style="color: #333333">.</span><span style="color: #0000CC">IDENTITY</span><span style="color: #333333">)</span>
	<span style="color: #008800; font-weight: bold">private</span> Integer cidade_id<span style="color: #333333">;</span>
	<span style="color: #008800; font-weight: bold">private</span> String cidade_nome<span style="color: #333333">;</span>
	<span style="color: #008800; font-weight: bold">private</span> Double tamanho_cidade<span style="color: #333333">;</span>

<span style="color: #333333">}</span>
</pre></td></tr></table></div>

        <li><p>Make a java <b>CriaCidades class</b>, and execute it.</p></li>
        <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid red; "><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">package</span> br<span style="color: #333333">.</span><span style="color: #0000CC">com</span><span style="color: #333333">.</span><span style="color: #0000CC">tutoria</span><span style="color: #333333">.</span><span style="color: #0000CC">cidades</span><span style="color: #333333">;</span>

<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">javax.persistence.EntityManager</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">javax.persistence.EntityManagerFactory</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">javax.persistence.Persistence</span><span style="color: #333333">;</span>

<span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">CriaCidades</span> <span style="color: #333333">{</span>
	<span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">static</span> <span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">main</span><span style="color: #333333">(</span>String<span style="color: #333333">[]</span> args<span style="color: #333333">)</span> <span style="color: #333333">{</span>
		Cidades cidade <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Cidades<span style="color: #333333">();</span>
		cidade<span style="color: #333333">.</span><span style="color: #0000CC">setCidade_nome</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Piracicaba&quot;</span><span style="color: #333333">);</span>
		cidade<span style="color: #333333">.</span><span style="color: #0000CC">setTamanho_cidade</span><span style="color: #333333">(</span><span style="color: #6600EE; font-weight: bold">17000000.0</span><span style="color: #333333">);</span>
		EntityManagerFactory emf <span style="color: #333333">=</span> Persistence<span style="color: #333333">.</span><span style="color: #0000CC">createEntityManagerFactory</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;mysqlale_mysql_1&quot;</span><span style="color: #333333">);</span>
		EntityManager em <span style="color: #333333">=</span> emf<span style="color: #333333">.</span><span style="color: #0000CC">createEntityManager</span><span style="color: #333333">();</span>
		
		em<span style="color: #333333">.</span><span style="color: #0000CC">getTransaction</span><span style="color: #333333">().</span><span style="color: #0000CC">begin</span><span style="color: #333333">();</span>
		em<span style="color: #333333">.</span><span style="color: #0000CC">persist</span><span style="color: #333333">(</span>cidade<span style="color: #333333">);</span>
		em<span style="color: #333333">.</span><span style="color: #0000CC">getTransaction</span><span style="color: #333333">().</span><span style="color: #0000CC">commit</span><span style="color: #333333">();</span>
		em<span style="color: #333333">.</span><span style="color: #0000CC">close</span><span style="color: #333333">();</span>
		System<span style="color: #333333">.</span><span style="color: #0000CC">out</span><span style="color: #333333">.</span><span style="color: #0000CC">println</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot; Close connection&quot;</span><span style="color: #333333">);</span>
	<span style="color: #333333">}</span>
<span style="color: #333333">}</span>
</pre></td></tr></table></div>
    <li>Now you should see <b>mysql docker image</b></li>
    <li>Go back to <code>mysql shell environment, so you can prove, that this information was record in mysql database</code></li>
    <li><p>Type:<code>select * from Cidades;</code> and you will see</p></li>
    <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid red; "><table><tr><td><pre style="margin: 0; line-height: 125%">1
2
3
4
5</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #333333">+</span><span style="color: #888888">-----------+-------------+----------------+</span>
<span style="color: #333333">|</span> cidade_id <span style="color: #333333">|</span> cidade_nome <span style="color: #333333">|</span> tamanho_cidade <span style="color: #333333">|</span>
<span style="color: #333333">+</span><span style="color: #888888">-----------+-------------+----------------+</span>
<span style="color: #333333">|</span>         <span style="color: #0000DD; font-weight: bold">1</span> <span style="color: #333333">|</span> Piracicaba  <span style="color: #333333">|</span>       <span style="color: #0000DD; font-weight: bold">17000000</span> <span style="color: #333333">|</span>
<span style="color: #333333">+</span><span style="color: #888888">-----------+-------------+----------------+</span>
</pre></td></tr></table></div>
    <li><p>You could also saw this on DBeaver</p></li>
    <li><p>If you want to see in Eclipse-IDE, you have to execute a <b>ImprimeCidades class</b>:</p></li>
    <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid red; "><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">package</span> br<span style="color: #333333">.</span><span style="color: #0000CC">com</span><span style="color: #333333">.</span><span style="color: #0000CC">tutoria</span><span style="color: #333333">.</span><span style="color: #0000CC">cidades</span><span style="color: #333333">;</span>

<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.sql.Connection</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.sql.DriverManager</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.sql.ResultSet</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.sql.SQLException</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.sql.Statement</span><span style="color: #333333">;</span>



<span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">ImprimeCidades</span> <span style="color: #333333">{</span>
	<span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">static</span> <span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">main</span><span style="color: #333333">(</span>String<span style="color: #333333">[]</span> args<span style="color: #333333">)</span> <span style="color: #008800; font-weight: bold">throws</span> SQLException <span style="color: #333333">{</span>
		Connection myConn <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">;</span>
		Statement myStmt <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">;</span>
		ResultSet myRs <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">;</span>
		<span style="color: #333399; font-weight: bold">int</span> i<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span>
		<span style="color: #008800; font-weight: bold">try</span> <span style="color: #333333">{</span>
			<span style="color: #888888">// 1. Get a connection to database</span>
			myConn <span style="color: #333333">=</span> DriverManager<span style="color: #333333">.</span><span style="color: #0000CC">getConnection</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;jdbc:mysql://localhost:3306/mysql&quot;</span><span style="color: #333333">,</span> <span style="background-color: #fff0f0">&quot;root&quot;</span> <span style="color: #333333">,</span> <span style="background-color: #fff0f0">&quot;password&quot;</span><span style="color: #333333">);</span>
			
			System<span style="color: #333333">.</span><span style="color: #0000CC">out</span><span style="color: #333333">.</span><span style="color: #0000CC">println</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Database connection successful!\n&quot;</span><span style="color: #333333">);</span>
			
			<span style="color: #888888">// 2. Create a statement</span>
			myStmt <span style="color: #333333">=</span> myConn<span style="color: #333333">.</span><span style="color: #0000CC">createStatement</span><span style="color: #333333">();</span>
			
			<span style="color: #888888">// 3. Execute SQL query</span>
			myRs <span style="color: #333333">=</span> myStmt<span style="color: #333333">.</span><span style="color: #0000CC">executeQuery</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;select * from Cidades&quot;</span><span style="color: #333333">);</span>
			
			<span style="color: #888888">// 4. Process the result set</span>
			<span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">(</span>myRs<span style="color: #333333">.</span><span style="color: #0000CC">next</span><span style="color: #333333">())</span> <span style="color: #333333">{</span>
				System<span style="color: #333333">.</span><span style="color: #0000CC">out</span><span style="color: #333333">.</span><span style="color: #0000CC">println</span><span style="color: #333333">(</span>i <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;: &quot;</span> <span style="color: #333333">+</span> myRs<span style="color: #333333">.</span><span style="color: #0000CC">getString</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;cidade_nome&quot;</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;, &quot;</span> <span style="color: #333333">+</span> myRs<span style="color: #333333">.</span><span style="color: #0000CC">getString</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;tamanho_cidade&quot;</span><span style="color: #333333">));</span>
				i<span style="color: #333333">++;</span>
			<span style="color: #333333">}</span>
		<span style="color: #333333">}</span>
		<span style="color: #008800; font-weight: bold">catch</span> <span style="color: #333333">(</span>Exception exc<span style="color: #333333">)</span> <span style="color: #333333">{</span>
			exc<span style="color: #333333">.</span><span style="color: #0000CC">printStackTrace</span><span style="color: #333333">();</span>
		<span style="color: #333333">}</span>
		<span style="color: #008800; font-weight: bold">finally</span> <span style="color: #333333">{</span>
			<span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>myRs <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
				myRs<span style="color: #333333">.</span><span style="color: #0000CC">close</span><span style="color: #333333">();</span>
			<span style="color: #333333">}</span>
			
			<span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>myStmt <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
				myStmt<span style="color: #333333">.</span><span style="color: #0000CC">close</span><span style="color: #333333">();</span>
			<span style="color: #333333">}</span>
			
			<span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>myConn <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
				myConn<span style="color: #333333">.</span><span style="color: #0000CC">close</span><span style="color: #333333">();</span>
			<span style="color: #333333">}</span>
		<span style="color: #333333">}</span>
	<span style="color: #333333">}</span>

<span style="color: #333333">}</span>
</pre></td></tr></table></div>

   




    </ol>
    </body>
	<!--E-N-D-->
	<footer><div class="_footer"></div></footer>
</html>

